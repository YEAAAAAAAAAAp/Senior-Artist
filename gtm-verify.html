<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GTM-GA4 CTA ì¶”ì  ê²€ì¦ ë„êµ¬</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; background: #f5f5f5; }
        .container { max-width: 1200px; margin: 0 auto; background: white; padding: 20px; border-radius: 8px; }
        .status { padding: 15px; margin: 10px 0; border-radius: 5px; }
        .success { background: #d4edda; border: 1px solid #c3e6cb; color: #155724; }
        .warning { background: #fff3cd; border: 1px solid #ffeaa7; color: #856404; }
        .error { background: #f8d7da; border: 1px solid #f5c6cb; color: #721c24; }
        .test-btn { background: #28a745; color: white; padding: 10px 20px; border: none; border-radius: 5px; margin: 5px; cursor: pointer; }
        .test-btn:hover { background: #218838; }
        .log { background: #f8f9fa; padding: 10px; border-radius: 5px; font-family: monospace; font-size: 12px; max-height: 300px; overflow-y: auto; }
        .metric { display: inline-block; margin: 10px; padding: 15px; background: #e9ecef; border-radius: 5px; min-width: 120px; text-align: center; }
        .metric-value { font-size: 24px; font-weight: bold; color: #007bff; }
        .checklist { list-style: none; padding: 0; }
        .checklist li { padding: 8px; margin: 5px 0; border-left: 4px solid #007bff; background: #f8f9fa; }
        .checklist .done { border-left-color: #28a745; background: #d4edda; }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ” GTM-GA4 CTA ì¶”ì  ìµœì¢… ê²€ì¦</h1>
        
        <div id="gtm-status" class="status">
            <strong>GTM ìƒíƒœ:</strong> í™•ì¸ ì¤‘...
        </div>
        
        <div id="dataLayer-status" class="status">
            <strong>DataLayer ìƒíƒœ:</strong> í™•ì¸ ì¤‘...
        </div>

        <h2>ğŸ“Š ì‹¤ì‹œê°„ ë©”íŠ¸ë¦­</h2>
        <div>
            <div class="metric">
                <div class="metric-value" id="bound-count">0</div>
                <div>ë°”ì¸ë”©ëœ CTA</div>
            </div>
            <div class="metric">
                <div class="metric-value" id="event-count">0</div>
                <div>ì „ì†¡ëœ ì´ë²¤íŠ¸</div>
            </div>
            <div class="metric">
                <div class="metric-value" id="error-count">0</div>
                <div>ì˜¤ë¥˜ ê°œìˆ˜</div>
            </div>
        </div>

        <h2>ğŸ§ª í…ŒìŠ¤íŠ¸ ë„êµ¬</h2>
        <button class="test-btn" onclick="testDataLayerAccess()">DataLayer ì ‘ê·¼ í…ŒìŠ¤íŠ¸</button>
        <button class="test-btn" onclick="testCTABinding()">CTA ë°”ì¸ë”© ê²€ì¦</button>
        <button class="test-btn" onclick="simulateClicks()">í´ë¦­ ì‹œë®¬ë ˆì´ì…˜</button>
        <button class="test-btn" onclick="clearLogs()">ë¡œê·¸ ì§€ìš°ê¸°</button>

        <h2>ğŸ“‹ GA4 ì—°ê²° ì²´í¬ë¦¬ìŠ¤íŠ¸</h2>
        <ul class="checklist" id="checklist">
            <li>GTM ì»¨í…Œì´ë„ˆ ë¡œë“œ í™•ì¸</li>
            <li>DataLayer ì´ˆê¸°í™” í™•ì¸</li>
            <li>CTA ìš”ì†Œ ë°”ì¸ë”© í™•ì¸</li>
            <li>ì´ë²¤íŠ¸ ì „ì†¡ í…ŒìŠ¤íŠ¸</li>
            <li>GA4 ë°ì´í„° ìˆ˜ì‹  í™•ì¸</li>
        </ul>

        <h2>ğŸ“ ì‹¤ì‹œê°„ ë¡œê·¸</h2>
        <div id="log" class="log"></div>

        <h2>ğŸ¯ GA4 í™•ì¸ ë°©ë²•</h2>
        <div class="status">
            <strong>GA4ì—ì„œ ë°ì´í„° í™•ì¸í•˜ëŠ” ë°©ë²•:</strong><br>
            1. GA4 ì†ì„± (G-DE2ZNKWV2W) ì ‘ì†<br>
            2. ë³´ê³ ì„œ > ì‹¤ì‹œê°„ > ê°œìš” ë©”ë‰´ë¡œ ì´ë™<br>
            3. ì´ë²¤íŠ¸ ì„¹ì…˜ì—ì„œ "cta_click" ì´ë²¤íŠ¸ í™•ì¸<br>
            4. ì´ë²¤íŠ¸ë¥¼ í´ë¦­í•˜ì—¬ ì„¸ë¶€ íŒŒë¼ë¯¸í„° í™•ì¸<br>
            5. cta_name, cta_type, cta_location ë“± ë§ì¶¤ ì¸¡ì •ê¸°ì¤€ ë°ì´í„° ê²€ì¦
        </div>
    </div>

    <script>
        let eventCount = 0;
        let errorCount = 0;

        function log(message, type = 'info') {
            const logDiv = document.getElementById('log');
            const timestamp = new Date().toLocaleTimeString();
            const color = type === 'error' ? '#dc3545' : type === 'success' ? '#28a745' : '#6c757d';
            logDiv.innerHTML += `<div style="color: ${color}">[${timestamp}] ${message}</div>`;
            logDiv.scrollTop = logDiv.scrollHeight;
        }

        function updateMetric(id, value) {
            document.getElementById(id).textContent = value;
        }

        function updateChecklist(index, done = true) {
            const items = document.querySelectorAll('.checklist li');
            if (items[index]) {
                if (done) items[index].classList.add('done');
                else items[index].classList.remove('done');
            }
        }

        function testDataLayerAccess() {
            log('DataLayer ì ‘ê·¼ í…ŒìŠ¤íŠ¸ ì‹œì‘...');
            
            if (typeof window.dataLayer !== 'undefined') {
                log('âœ… DataLayer ë°œê²¬ë¨', 'success');
                log(`DataLayer ê¸¸ì´: ${window.dataLayer.length}`, 'info');
                
                // í…ŒìŠ¤íŠ¸ ì´ë²¤íŠ¸ ì „ì†¡
                window.dataLayer.push({
                    event: 'test_event',
                    test_parameter: 'verification_tool',
                    timestamp: Date.now()
                });
                
                log('âœ… í…ŒìŠ¤íŠ¸ ì´ë²¤íŠ¸ ì „ì†¡ ì™„ë£Œ', 'success');
                updateChecklist(1, true);
            } else {
                log('âŒ DataLayerë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤', 'error');
                errorCount++;
                updateMetric('error-count', errorCount);
            }
        }

        function testCTABinding() {
            log('CTA ë°”ì¸ë”© ê²€ì¦ ì‹œì‘...');
            
            const ctaElements = document.querySelectorAll('[data-cta-name], .cta-button, .choice-btn, .submit-btn');
            const boundElements = document.querySelectorAll('[data-gtm-bound]');
            
            log(`ë°œê²¬ëœ CTA ìš”ì†Œ: ${ctaElements.length}ê°œ`);
            log(`ë°”ì¸ë”©ëœ ìš”ì†Œ: ${boundElements.length}ê°œ`);
            
            updateMetric('bound-count', boundElements.length);
            
            if (boundElements.length > 0) {
                log('âœ… CTA ë°”ì¸ë”© í™•ì¸ë¨', 'success');
                updateChecklist(2, true);
            } else {
                log('âš ï¸ ë°”ì¸ë”©ëœ ìš”ì†Œê°€ ì—†ìŠµë‹ˆë‹¤', 'warning');
            }
        }

        function simulateClicks() {
            log('í´ë¦­ ì‹œë®¬ë ˆì´ì…˜ ì‹œì‘...');
            
            const testEvent = {
                event: 'cta_click',
                event_category: 'engagement',
                event_label: 'test_cta',
                cta_name: 'verification_test',
                cta_type: 'test',
                cta_location: 'verification_tool',
                cta_text: 'Test CTA Click',
                element_type: 'button',
                element_class: 'test-btn',
                timestamp: Date.now()
            };

            if (window.dataLayer) {
                window.dataLayer.push(testEvent);
                eventCount++;
                updateMetric('event-count', eventCount);
                log('âœ… ì‹œë®¬ë ˆì´ì…˜ ì´ë²¤íŠ¸ ì „ì†¡ ì™„ë£Œ', 'success');
                updateChecklist(3, true);
            } else {
                log('âŒ DataLayer ì ‘ê·¼ ì‹¤íŒ¨', 'error');
                errorCount++;
                updateMetric('error-count', errorCount);
            }
        }

        function clearLogs() {
            document.getElementById('log').innerHTML = '';
            log('ë¡œê·¸ê°€ ì§€ì›Œì¡ŒìŠµë‹ˆë‹¤.');
        }

        function checkGTMStatus() {
            if (window.google_tag_manager) {
                document.getElementById('gtm-status').className = 'status success';
                document.getElementById('gtm-status').innerHTML = '<strong>GTM ìƒíƒœ:</strong> âœ… ì •ìƒ ë¡œë“œë¨';
                updateChecklist(0, true);
            } else {
                document.getElementById('gtm-status').className = 'status error';
                document.getElementById('gtm-status').innerHTML = '<strong>GTM ìƒíƒœ:</strong> âŒ ë¡œë“œë˜ì§€ ì•ŠìŒ';
            }

            if (window.dataLayer) {
                document.getElementById('dataLayer-status').className = 'status success';
                document.getElementById('dataLayer-status').innerHTML = '<strong>DataLayer ìƒíƒœ:</strong> âœ… ì´ˆê¸°í™”ë¨';
                updateChecklist(1, true);
            } else {
                document.getElementById('dataLayer-status').className = 'status error';
                document.getElementById('dataLayer-status').innerHTML = '<strong>DataLayer ìƒíƒœ:</strong> âŒ ì´ˆê¸°í™”ë˜ì§€ ì•ŠìŒ';
            }
        }

        // í˜ì´ì§€ ë¡œë“œ í›„ ìƒíƒœ í™•ì¸
        setTimeout(checkGTMStatus, 2000);
        
        // ì´ˆê¸° ë¡œê·¸
        log('GTM-GA4 CTA ì¶”ì  ê²€ì¦ ë„êµ¬ ì‹œì‘ë¨');
        log('ëª¨ë“  í…ŒìŠ¤íŠ¸ë¥¼ ìˆœì„œëŒ€ë¡œ ì‹¤í–‰í•´ë³´ì„¸ìš”.');
    </script>
</body>
</html>
<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GA4 í…ŒìŠ¤íŠ¸ í˜ì´ì§€</title>
    
    <!-- í†µí•© ì¶”ì  ì´ˆê¸°í™” (dataLayer ì¶©ëŒ ë°©ì§€) -->
    <script>
        // dataLayer ë¨¼ì € ì´ˆê¸°í™”
        window.dataLayer = window.dataLayer || [];
        
        // ì„¤ì • ë³€ìˆ˜ ë¯¸ë¦¬ ì •ì˜
        window.__GA_MEASUREMENT_ID__ = 'G-DE2ZNKWV2W';
        window.__GTM_ID__ = 'GTM-594SVWKB';
        
        console.log('[TRACKING] ğŸš€ Initializing unified tracking system');
    </script>
    
    <!-- Google Tag Manager -->
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
    new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
    j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
    'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
    })(window,document,'script','dataLayer','GTM-594SVWKB');</script>
    <!-- End Google Tag Manager -->
    
    <!-- Google Analytics 4 - GTMê³¼ ì•ˆì „í•˜ê²Œ ë³‘í–‰ -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-DE2ZNKWV2W"></script>
    <script>
        // dataLayerê°€ ì´ë¯¸ ì¡´ì¬í•˜ë¯€ë¡œ ì¬ì´ˆê¸°í™”í•˜ì§€ ì•ŠìŒ
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'G-DE2ZNKWV2W', { 
            send_page_view: true,  // í…ŒìŠ¤íŠ¸ë¥¼ ìœ„í•´ í˜ì´ì§€ë·° í™œì„±í™”
            transport_type: 'beacon',
            allow_enhanced_conversions: true
        });
        
        console.log('[GA4] âœ… GA4 initialized with GTM integration');
    </script>
    
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
        }
        
        .test-button {
            background: #4285f4;
            color: white;
            border: none;
            padding: 15px 30px;
            font-size: 16px;
            border-radius: 5px;
            cursor: pointer;
            margin: 10px;
            display: block;
            width: 300px;
        }
        
        .test-button:hover {
            background: #3367d6;
        }
        
        .status {
            padding: 10px;
            margin: 10px 0;
            border-radius: 5px;
            background: #f0f0f0;
        }
        
        .success {
            background: #d4edda;
            color: #155724;
        }
        
        .error {
            background: #f8d7da;
            color: #721c24;
        }
        
        #console-output {
            background: #000;
            color: #00ff00;
            padding: 15px;
            font-family: monospace;
            height: 400px;
            overflow-y: auto;
            white-space: pre-wrap;
        }
    </style>
</head>
<body>
    <!-- Google Tag Manager (noscript) -->
    <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-594SVWKB"
    height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <!-- End Google Tag Manager (noscript) -->

    <h1>ğŸ§ª GA4 ì¶”ì  í…ŒìŠ¤íŠ¸ í˜ì´ì§€</h1>
    
    <div class="status" id="status">
        <strong>ìƒíƒœ:</strong> ì´ˆê¸°í™” ì¤‘...
    </div>
    
    <h2>í…ŒìŠ¤íŠ¸ ë²„íŠ¼ë“¤</h2>
    
    <button class="test-button" id="test-btn-1" data-cta-type="primary" data-cta-name="test_button_1">
        í…ŒìŠ¤íŠ¸ ë²„íŠ¼ 1 - ê¸°ë³¸ CTA
    </button>
    
    <button class="test-button" id="test-btn-2" data-cta-type="secondary" data-cta-name="test_button_2">
        í…ŒìŠ¤íŠ¸ ë²„íŠ¼ 2 - ë³´ì¡° CTA  
    </button>
    
    <button class="test-button" id="manual-test" onclick="sendManualEvent()">
        ìˆ˜ë™ ì´ë²¤íŠ¸ ì „ì†¡ í…ŒìŠ¤íŠ¸
    </button>
    
    <button class="test-button" id="check-status" onclick="checkStatus()">
        GA4/GTM ìƒíƒœ í™•ì¸
    </button>
    
    <h2>ì‹¤ì‹œê°„ ì½˜ì†” ì¶œë ¥</h2>
    <div id="console-output"></div>
    
    <h2>ì‚¬ìš© ë°©ë²•</h2>
    <ol>
        <li>ì´ í˜ì´ì§€ë¥¼ ì—´ê³  ì½˜ì†”ì„ í™•ì¸í•˜ì„¸ìš” (F12)</li>
        <li>ìœ„ì˜ í…ŒìŠ¤íŠ¸ ë²„íŠ¼ë“¤ì„ í´ë¦­í•˜ì„¸ìš”</li>
        <li>GA4 ì‹¤ì‹œê°„ ê°œìš”ì—ì„œ ì´ë²¤íŠ¸ë¥¼ í™•ì¸í•˜ì„¸ìš”</li>
        <li>ì½˜ì†” ì¶œë ¥ì—ì„œ ì´ë²¤íŠ¸ ì „ì†¡ ìƒíƒœë¥¼ í™•ì¸í•˜ì„¸ìš”</li>
    </ol>
    
    <script src="js/ga-lite.js?v=202510062354"></script>
    <script src="js/init-ga.js?v=202510062354"></script>
    
    <script>
        // ì½˜ì†” ì¶œë ¥ì„ í˜ì´ì§€ì— í‘œì‹œ
        const consoleOutput = document.getElementById('console-output');
        const originalLog = console.log;
        const originalError = console.error;
        const originalWarn = console.warn;
        
        function addToOutput(message, type = 'log') {
            const timestamp = new Date().toLocaleTimeString();
            const line = `[${timestamp}] ${message}\n`;
            consoleOutput.textContent += line;
            consoleOutput.scrollTop = consoleOutput.scrollHeight;
        }
        
        console.log = function(...args) {
            originalLog.apply(console, args);
            addToOutput(args.join(' '), 'log');
        };
        
        console.error = function(...args) {
            originalError.apply(console, args);
            addToOutput('ERROR: ' + args.join(' '), 'error');
        };
        
        console.warn = function(...args) {
            originalWarn.apply(console, args);
            addToOutput('WARN: ' + args.join(' '), 'warn');
        };
        
        // ìˆ˜ë™ ì´ë²¤íŠ¸ ì „ì†¡ í•¨ìˆ˜
        function sendManualEvent() {
            console.log('[TEST] ìˆ˜ë™ ì´ë²¤íŠ¸ ì „ì†¡ ì‹œì‘');
            
            // GA4 ì§ì ‘ ì „ì†¡
            if (typeof gtag === 'function') {
                gtag('event', 'manual_test_event', {
                    event_category: 'test',
                    event_label: 'manual_trigger',
                    value: 1,
                    transport_type: 'beacon'
                });
                console.log('[TEST] âœ… GA4 ìˆ˜ë™ ì´ë²¤íŠ¸ ì „ì†¡ë¨');
            } else {
                console.error('[TEST] âŒ gtag í•¨ìˆ˜ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŒ');
            }
            
            // dataLayer ì§ì ‘ í‘¸ì‹œ
            window.dataLayer = window.dataLayer || [];
            window.dataLayer.push({
                event: 'manual_test_event',
                test_category: 'manual',
                test_action: 'button_click',
                timestamp: Date.now()
            });
            console.log('[TEST] âœ… dataLayer ìˆ˜ë™ í‘¸ì‹œ ì™„ë£Œ');
        }
        
        // ìƒíƒœ í™•ì¸ í•¨ìˆ˜
        function checkStatus() {
            console.log('[STATUS] === GA4/GTM ìƒíƒœ í™•ì¸ ===');
            console.log('[STATUS] gtag function:', typeof gtag);
            console.log('[STATUS] dataLayer:', Array.isArray(window.dataLayer));
            console.log('[STATUS] dataLayer length:', window.dataLayer?.length || 0);
            console.log('[STATUS] GA4Utils:', typeof window.GA4Utils);
            console.log('[STATUS] Measurement ID:', window.__GA_MEASUREMENT_ID__);
            console.log('[STATUS] GTM ID:', window.__GTM_ID__);
            
            // ë°”ì¸ë”©ëœ ìš”ì†Œ ìˆ˜ í™•ì¸
            const boundElements = document.querySelectorAll('[data-ga-bound]').length;
            console.log('[STATUS] Bound elements:', boundElements);
            
            // ìƒíƒœ ì—…ë°ì´íŠ¸
            const statusDiv = document.getElementById('status');
            statusDiv.innerHTML = `
                <strong>ìƒíƒœ:</strong> 
                GA4: ${typeof gtag === 'function' ? 'âœ…' : 'âŒ'} | 
                GTM: ${Array.isArray(window.dataLayer) ? 'âœ…' : 'âŒ'} | 
                GA4Utils: ${typeof window.GA4Utils !== 'undefined' ? 'âœ…' : 'âŒ'} |
                ë°”ì¸ë”©ëœ ìš”ì†Œ: ${boundElements}ê°œ
            `;
            statusDiv.className = 'status ' + (typeof gtag === 'function' && Array.isArray(window.dataLayer) ? 'success' : 'error');
        }
        
        // í˜ì´ì§€ ë¡œë“œ í›„ ì´ˆê¸° ìƒíƒœ í™•ì¸
        setTimeout(() => {
            checkStatus();
        }, 2000);
        
        // ì£¼ê¸°ì  ìƒíƒœ í™•ì¸ (10ì´ˆë§ˆë‹¤)
        setInterval(checkStatus, 10000);
    </script>
</body>
</html>